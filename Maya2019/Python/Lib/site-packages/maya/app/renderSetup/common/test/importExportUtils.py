"""Utilities for render setup import / export testing."""

import maya.app.renderSetup.model.renderSetup as renderSetup
import maya.app.renderSetup.model.jsonTranslatorGlobals as jsonTranslatorGlobals
import maya.app.renderSetup.common.guard as guard
import maya.app.renderSetup.model.renderSetupPreferences as userPrefs

import json

# Cannot name function "import", as this is a reserved Python keyword.
def importFile(filename):
    with open(filename, "r") as file:
        renderSetup.instance().decode(json.load(file), renderSetup.DECODE_AND_OVERWRITE, None)

def importFileNoLabelColor(filename):
    with guard.StateGuardCtx(jsonTranslatorGlobals.importLabelColorEnabled, jsonTranslatorGlobals.enableImportLabelColor, False):
        importFile(filename)

def exportFile(filename, includeSceneSettings=True):
    with open(filename, "w+") as file:
        json.dump(renderSetup.instance().encode(None, includeSceneSettings), fp=file, indent=2, sort_keys=True)

def exportFileNoLabelColor(filename):
    with guard.StateGuardCtx(jsonTranslatorGlobals.exportLabelColorEnabled, jsonTranslatorGlobals.enableExportLabelColor, False):
        exportFile(filename)

def exportFileNoRenderSettings(filename):
    with guard.StateGuardCtx(userPrefs.ExportRenderSettingsAOVs.getOptionVar, userPrefs.ExportRenderSettingsAOVs.setOptionVar, False):
        exportFile(filename, False)

def readFile(file):
    """Returns a list of the lines in the argument file."""
    with open(file, 'r') as f:
        data = f.read().split('\n')
        # Strip data of any windows newline character
        data = [d.rstrip('\r') for d in data]
        return data
# ===========================================================================
# Copyright 2018 Autodesk, Inc. All rights reserved.
#
# Use of this software is subject to the terms of the Autodesk license
# agreement provided at the time of installation or download, or which
# otherwise accompanies this software in either electronic or hard copy form.
# ===========================================================================
